# 管理员功能说明

## 概述

本系统为管理员用户提供了专门的管理界面，支持用户管理和语料管理功能。管理员可以查看所有用户信息，管理语料清单，并支持语料所有权转移。

## 功能特性

### 1. 用户管理
- **查看所有用户**: 管理员可以查看系统中所有注册用户的详细信息
- **用户搜索**: 支持按用户账号进行模糊搜索
- **用户信息展示**: 显示用户ID、账号、昵称、用户类型、手机号、性别、账号状态、创建时间等
- **快速操作**: 可直接跳转查看特定用户的语料清单

### 2. 语料管理
- **查看所有语料**: 管理员可以查看系统中所有用户创建的语料清单
- **多维度搜索**: 
  - 按语料名称搜索
  - 按用户账号搜索
  - 支持组合搜索
- **语料信息展示**: 显示语料ID、名称、所有者信息、语种、数据格式、数据量、创建时间等
- **批量操作**: 支持批量选择和转移语料所有权

### 3. 语料转移功能
- **批量选择**: 支持勾选多个语料进行批量转移
- **用户搜索**: 转移时可搜索目标用户
- **确认机制**: 转移前需要二次确认，防止误操作
- **实时反馈**: 转移成功后显示详细结果信息

## 技术实现

### 后端实现
- **权限控制**: 使用 `AdminAuthInterceptor` 拦截器确保只有管理员可以访问管理接口
- **数据传输**: 使用 `CorpusWithUserInfo` DTO 类优化数据传输，减少数据库查询次数
- **事务管理**: 语料转移操作使用 `@Transactional` 注解确保数据一致性
- **错误处理**: 统一的错误处理机制，提供友好的错误提示

### 前端实现
- **UI框架**: 使用 Element Plus 组件库构建现代化管理界面
- **路由保护**: 通过路由守卫确保只有管理员用户可以访问管理页面
- **状态管理**: 使用 Pinia 管理用户状态和权限信息
- **用户体验**: 提供加载状态、分页、搜索、确认对话框等交互功能

## 使用方法

### 1. 登录管理员账号
确保使用 `userType` 为 `admin` 的账号登录系统。

### 2. 访问管理界面
登录后，管理员用户会在导航栏看到"后台管理"菜单，包含：
- 用户管理
- 语料库管理

### 3. 用户管理操作
1. 点击"用户管理"进入用户列表页面
2. 使用搜索框按账号搜索特定用户
3. 点击"查看语料"按钮可查看特定用户的所有语料

### 4. 语料管理操作
1. 点击"语料库管理"进入语料列表页面
2. 使用搜索框按语料名称或用户账号搜索
3. 勾选需要转移的语料
4. 点击"转移选中的语料"按钮
5. 在弹出的对话框中搜索并选择目标用户
6. 确认转移操作

## 数据库设计

### 用户表 (users)
- `user_type`: 区分普通用户和管理员用户
- 管理员用户的 `user_type` 字段值为 `admin`

### 语料表 (corpus)  
- `creator_id`: 外键关联到用户表，标识语料的所有者
- 转移操作实际上是修改 `creator_id` 字段的值

## 安全考虑

1. **权限验证**: 所有管理员接口都需要验证用户类型
2. **参数校验**: 对所有输入参数进行严格校验
3. **操作日志**: 重要操作（如语料转移）会记录相关日志
4. **事务保护**: 确保数据操作的原子性和一致性

## 扩展功能建议

1. **操作日志**: 记录管理员的所有操作行为
2. **批量用户操作**: 支持批量禁用/启用用户账号
3. **数据统计**: 提供用户和语料的统计报表
4. **权限细分**: 支持更细粒度的权限控制
5. **通知机制**: 语料转移后通知相关用户

## 故障排除

### 常见问题
1. **无法访问管理界面**: 检查当前用户的 `userType` 是否为 `admin`
2. **语料转移失败**: 检查目标用户是否存在，语料是否有效
3. **搜索无结果**: 确认搜索条件是否正确，数据是否存在

### 日志查看
- 后端日志: 查看应用日志文件
- 前端日志: 打开浏览器开发者工具查看控制台输出 